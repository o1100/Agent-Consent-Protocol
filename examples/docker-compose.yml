# ACP Docker Compose â€” Agent in isolated container
#
# ACP runs on the host. The agent runs in an isolated container.
# All traffic goes through ACP's consent gate.
#
# Usage:
#   # Start ACP on host first:
#   acp init --channel=telegram
#
#   # Then run agent in container:
#   acp contain -- python my_agent.py

# This compose file is for manual Docker deployments.
# For most users, `acp contain` handles everything automatically.

services:
  agent:
    image: python:3.12-slim  # Replace with your agent's image
    environment:
      - HTTP_PROXY=http://host.docker.internal:8444
      - HTTPS_PROXY=http://host.docker.internal:8444
      - ACP_CONSENT_URL=http://host.docker.internal:8443
      - ACP_SANDBOX=1
      - ACP_CONTAINED=1
    networks:
      - isolated
    read_only: true
    tmpfs:
      - /tmp:size=100m
    cap_drop:
      - ALL
    security_opt:
      - no-new-privileges

networks:
  isolated:
    internal: true  # No external connectivity
