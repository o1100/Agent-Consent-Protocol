# ACP Strict Policy — Paranoid mode
# Ask for everything except reads. Financial actions are blocked by default.

version: "1"
default_action: ask

rules:
  # ── HTTP Rules ──────────────────────────────────
  # (Enforced in both proxy-only and contained mode)

  # LLM providers (allow so the agent can function)
  - match: { kind: http, host: "*.anthropic.com" }
    action: allow
  - match: { kind: http, host: "*.openai.com" }
    action: allow

  # All other HTTP — ask
  - match: { kind: http }
    action: ask
    level: high

  # ── Shell Rules ─────────────────────────────────
  # Container runtime basics (allow so the agent can start)
  - match: { kind: shell, tool: "shell:node" }
    action: allow
  - match: { kind: shell, tool: "shell:bash" }
    action: allow
  - match: { kind: shell, tool: "shell:sh" }
    action: allow

  # All other shell — critical approval
  - match: { kind: shell }
    action: ask
    level: critical

  # ── MCP Tool Rules ─────────────────────────────

  # Only reads are auto-approved
  - match: { category: read }
    action: allow

  # Financial actions: blocked unless explicitly approved
  - match: { category: financial }
    action: ask
    level: critical
    timeout: 120  # 2 min timeout

  # Shell commands: always ask, critical level
  - match: { tool: exec }
    action: ask
    level: critical

  # System operations: always ask, high level
  - match: { category: system }
    action: ask
    level: high

  # Communication: always ask, high level
  - match: { category: communication }
    action: ask
    level: high

  # Public posts: always ask, critical level
  - match: { category: public }
    action: ask
    level: critical

  # Everything else: ask
  - match: { tool: "*" }
    action: ask
    level: medium
    rate_limit: 10/minute
